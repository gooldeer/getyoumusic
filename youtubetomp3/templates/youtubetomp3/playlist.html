{% extends "youtubetomp3/base.html" %}

{% block title %}{{ playlist.name }}{% endblock %}

{% block style %}
  {% load staticfiles %}
  <link href="{% static 'css/playlist.css' %}" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="{% static 'css/audio.css' %}"/>
{% endblock %}

{% block sidebar %}
  <ul class="nav navbar-nav">
    <li><a href="{% url 'youtubetomp3:playlists' %}">To playlists</a></li>
  </ul>
{% endblock %}

{% block content %}
  {% csrf_token %}

  <div class="card">
    <div class="container">

      <h1 id="playlistName">{{ playlist.name }}</h1>

      <a data-toggle="modal" href="#changeNameModal" type="button">Change name</a>

      <a class="header-right-button" rel="popover" data-original-title="Pick color" data-placement="left" href="#">

        {% with "img/"|add:playlist.color|add:".png" as image %}
        <img id="color" src="{% static image %}">
        {% endwith %}

      </a>

      <hr>

      <table class="songs" border="0">

        {% for media in media_set %}

          {% if playlist.is_audio %}
        
            {% include "youtubetomp3/audio.html" %}

          {% else %}

            <tr>

              <td>

                <video width="320" heigth="240" preload="metadata" controls>
                  <source src="{% url 'youtubetomp3:audio' playlistName=playlist.name media=media.link_to_play mediatype='video/webm'  %}" type="video/webm"/>
                  <source src="{% url 'youtubetomp3:audio' playlistName=playlist.name media=media.link_to_load mediatype='video/mp4'  %}" type="video/mp4"/>
                  Bad browser
                </video>

                <td>
                    <p>{{ media.link_to_play }}</p>
                    <a href="{% url 'youtubetomp3:remove_media' playlistName=playlist.name media=media.link_to_play %}" method="GET">
                        Remove
                    </a>
                </td>

              </td>

            </tr>

          {% endif %}

        {% endfor %}

      </table>


    </div>
  </div>

  <div id="popover_content_wrapper" style="display: none">
    <table border="0" style="width: 100%">

      <tr>
          <td>
              <a onclick="changeColor('{% url 'youtubetomp3:change_playlist' playlist.name playlist.name 'fff' %}')"
                 href="#">
                <div class="color-square" style="background-color: #fff"></div>
              </a>
          </td>
          <td>
            <a onclick="changeColor('{% url 'youtubetomp3:change_playlist' playlist.name playlist.name 'ffcccc' %}')"
                 href="#">
              <div class="color-square" style="background-color: #ffcccc"></div>
            </a>
          </td>
          <td>
            <a onclick="changeColor('{% url 'youtubetomp3:change_playlist' playlist.name playlist.name 'cfecfa' %}')"
                 href="#">
              <div class="color-square" style="background-color: #cfecfa"></div>
            </a>
          </td>
      </tr>

      <tr>
          <td>
            <a onclick="changeColor('{% url 'youtubetomp3:change_playlist' playlist.name playlist.name 'ebfde1' %}')"
                 href="#">
              <div class="color-square" style="background-color: #ebfde1"></div>
            </a>
          </td>
          <td>
            <a onclick="changeColor('{% url 'youtubetomp3:change_playlist' playlist.name playlist.name 'f5fec5' %}')"
                 href="#">
              <div class="color-square" style="background-color: #f5fec5"></div>
            </a>
          </td>
          <td>
            <a onclick="changeColor('{% url 'youtubetomp3:change_playlist' playlist.name playlist.name '7b7b7b' %}')"
                 href="#">
              <div class="color-square" style="background-color: #7b7b7b"></div>
            </a>
          </td>
      </tr>

    </table>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="changeNameModal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title">Change playlist</h4>
        </div>
        
        <form role="form" method="post" 
              action="{% url 'youtubetomp3:change_playlist' playlist.name playlist.name playlist.color %}" 
              enctype="multipart/form-data">

            {% csrf_token %}
            <div class="modal-body">
                <div class="input-group">
                  <input type="text" placeholder="Enter new name here" class="form-control" name="playlist" id="playlist" autofocus>
                </div><!-- /input-group -->
            </div>

            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-success">Change</button>
            </div>
        </form>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->

{% endblock %}

{% block javascript %}

  <script type="text/javascript" src="{% static 'js/playlist.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/audio.js' %}"></script>

{% endblock %}